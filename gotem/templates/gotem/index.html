<!DOCTYPE html>
<!--[if lt IE 7]>      <html class="no-js lt-ie9 lt-ie8 lt-ie7"> <![endif]-->
<!--[if IE 7]>         <html class="no-js lt-ie9 lt-ie8"> <![endif]-->
<!--[if IE 8]>         <html class="no-js lt-ie9"> <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js"> <!--<![endif]-->

{% include 'gotem/head.html' %}

<body>

<section class="sprints-area">{% include 'gotem/sprint-area.html' %}</section>

<script src="//ajax.googleapis.com/ajax/libs/jquery/1.8.2/jquery.min.js"></script>
<script>window.jQuery || document.write('<script src="js/vendor/jquery-1.8.2.min.js"><\/script>')</script>
<!--
<script src="js/plugins.js"></script>
<script src="js/main.js"></script> -->

<script>
    function apply_form_field_error(fieldname, error) {
        var input = $("#id_" + fieldname),
            error_msg = $("<span />").addClass("help-inline ajax-error").text(error[0]);
        error_msg.insertAfter(input);
    }

    function clear_form_field_errors(form) {
        $(".ajax-error", $(form)).remove();
    }

    $(document).ready(function() {
        $('.objective-list').load("{% url 'objective_list' %}");
        $('#objective-form').submit(function(e) {
            e.preventDefault();
            clear_form_field_errors(this);
            $.ajax({
                data: $(this).serialize(),
                type: $(this).attr('method'),
                url: $(this).attr('action'),
                success: function(data, textStatus, jqXHR) {
                    $('.objective-list').load("{% url 'objective_list' %}");
                },
                error: function(data, textStatus, jqXHR) {
                    var errors = $.parseJSON(data.responseText);
                    $.each(errors, function(index, value) {
                        apply_form_field_error(index, value);
                    });
                }
            });
            return false;
        });
    });
</script>

</body>
</html>